<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>功夫茶 KUNG FU TEA - 線上點餐 v2.1.0</title>
  
  <!-- 外部CSS文件 -->
  <link rel="stylesheet" href="style.css">
  
  <!-- Google Maps API - 延遲載入以提升頁面速度 -->
  <script>
    // 延遲載入Google Maps API
    function loadGoogleMapsAPI() {
      const script = document.createElement('script');
      script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBFw0Qbyq9zTFTd-tUY6d4WYgx3vHkzJ7w&libraries=geometry&callback=initDistanceCalculation';
      script.async = true;
      script.defer = true;
      document.head.appendChild(script);
    }
    
    // 當用戶開始輸入地址時才載入API
    window.loadMapsAPI = loadGoogleMapsAPI;
  </script>
</head>

<body>
  <div class="kungfu-tea-ordering">
    <div class="container">
      <header>
        <h1>功夫茶 KUNG FU TEA</h1>
        <div class="subtitle">點餐文字生成器 v2.1.0</div>
        <div class="store-info">
          <div class="store-address">
            📍 楊梅區四維路90號
          </div>
          <div class="store-navigation">
            <a href="https://foodpanda.go.link/34CwH" target="_blank" class="nav-link delivery-link foodpanda-link">
              <span class="delivery-icon foodpanda-icon">🐼</span>foodpanda
            </a>
            <a href="https://www.ubereats.com/tw/store/%E5%8A%9F%E5%A4%AB%E8%8C%B6-kungfutea-%E6%A5%8A%E6%A2%85%E5%9B%9B%E7%B6%AD%E5%BA%97/zo2ii2cgUcCaK5-5O96-Fw?diningMode=DELIVERY&ps=1&sc=SEARCH_SUGGESTION" target="_blank" class="nav-link delivery-link ubereats-link" style="margin-left: 10px;">
              <span class="delivery-icon ubereats-icon">🍽️</span>Uber Eats
            </a>
            <a href="tel:03-4882975" class="phone-link" style="margin-left: 10px;">
              <span class="delivery-icon phone-icon">📞</span>電話：03-4882975
            </a>
            <a href="https://maps.app.goo.gl/DmhQah32YQhwvBE98" target="_blank" class="nav-link" style="margin-left: 10px;">
              🗺️ 導航到四維路90號
            </a>
          </div>
        </div>
      </header>

      <div class="main-content">
        <!-- 菜單區域 -->
        <div class="section">
          <h2 class="section-title">菜單</h2>
          <div id="menu-container"></div>
        </div>

        <!-- 訂單與訂購資訊合併區域 -->
        <div class="section order-section">
          <h2 class="section-title">您的訂單</h2>
          <div id="order-container">
            <div class="empty-order">尚未選擇任何飲品</div>
          </div>

          <div class="total-section">
            <div class="total-amount">總計: $<span id="total-amount">0</span></div>
          </div>

          <h3 style="color: #764ba2; margin: 20px 0 15px 0; border-top: 2px solid #e0e6ff; padding-top: 15px;">訂購資訊</h3>
          <div class="customer-info">
            <div class="info-group">
              <label for="customer-name">訂購人姓名</label>
              <input type="text" id="customer-name" placeholder="請輸入姓名">
            </div>
            <div class="info-group">
              <label for="customer-phone">聯絡電話</label>
              <input type="tel" id="customer-phone" placeholder="聯絡電話or公司電話#分機">
            </div>
            <div class="info-group">
              <label for="delivery-address">外送地址</label>
              <input type="text" id="delivery-address" placeholder="外送地址+(公司行號)">
              <!-- 距離計算結果顯示 -->
              <div id="distance-result" class="distance-info" style="display: none;">
                <div class="distance-display">
                  <span class="distance-icon">📍</span>
                  <span class="distance-text">距離店家: <span id="distance-value">-</span>公里</span>
                </div>
                <div class="delivery-level" id="delivery-level">
                  <span class="level-icon">🚚</span>
                  <span class="level-text">外送級別: <span id="level-value">-</span></span>
                </div>
                <div class="free-shipping-info" id="free-shipping-info">
                  <span class="free-icon">💰</span>
                  <span class="free-text">免運條件: <span id="free-shipping-value">-</span></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 預覽區域 -->
        <div class="section">
          <h2 class="section-title">請確認以下訂單預覽</h2>
          <div class="preview-area" id="order-preview">請先填寫訂購資訊和選擇飲品...</div>

          <div class="order-controls">
            <button class="btn btn-secondary" id="save-order">💾 儲存訂單</button>
            <button class="btn btn-secondary" id="load-orders">📋 載入訂單</button>
            <button class="btn btn-secondary" id="clear-order">🗑️ 清空訂單</button>
          </div>

          <button class="copy-btn" id="copy-order" disabled>📋 複製訂單文字</button>
          <button class="btn btn-primary" id="send-order" disabled>📱 發送功夫茶楊梅四維店官方帳號</button>
        </div>
      </div>

      <!-- 外送金額查詢區域 -->
      <div class="section" style="margin-top: 30px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h2 class="section-title" style="margin-bottom: 0;">外送免運條件查詢</h2>
          <button id="toggle-delivery-fee" class="btn btn-secondary" style="padding: 8px 15px; font-size: 0.9rem;">
            📋 顯示查詢表
          </button>
        </div>

        <div id="delivery-fee-content" style="display: none;">
          <div style="background: #f8f9ff; border-radius: 10px; padding: 20px; margin-bottom: 15px;">
            <h3 style="color: #667eea; margin-bottom: 15px; text-align: center;">🚚 外送距離與運費對照表</h3>
            <div style="overflow-x: auto;">
              <table id="delivery-fee-table" style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                <thead>
                  <tr style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                    <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">外送距離</th>
                    <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">運費</th>
                    <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">免運費條件</th>
                    <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">訂購金額需達</th>
                  </tr>
                </thead>
                <tbody id="delivery-fee-tbody">
                  <!-- 動態生成表格內容 -->
                </tbody>
              </table>
            </div>
          </div>

          <div style="background: #e8f4fd; border-left: 4px solid #667eea; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
            <h4 style="color: #667eea; margin-bottom: 10px;">💡 使用說明：</h4>
            <ul style="margin: 0; padding-left: 20px; color: #333;">
              <li>根據您的地址距離選擇對應的運費</li>
              <li>達到免運費條件即可免收運費</li>
              <li>未達免運條件時，需支付對應運費</li>
              <li>最低訂購金額請參考「訂購金額需達」欄位</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- 實用工具區域 -->
      <div class="section" style="margin-top: 30px;">
        <h2 class="section-title">實用工具</h2>
        <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
          <a href="https://property-rr6ksz.manus.space" target="_blank" class="nav-link" style="background: linear-gradient(135deg, #4CAF50, #45a049);">
            🏠 買賣試算系統
          </a>
          <a href="https://lin.ee/HzGBJ8e" target="_blank" class="nav-link" style="background: linear-gradient(135deg, #00C300, #00A000);">
            🏠 免費諮詢房地產
          </a>
          <a href="https://realtor.houseprice.tw/agent/buy/0925666597/" target="_blank" class="nav-link" style="background: linear-gradient(135deg, #FF6B35, #E55A2B);">
            🏡 房屋精選物件
          </a>
          <a href="https://line.me/ti/g2/VXIuR9NyhkWFQPuMeWTUp_RHitaW82_0r8MU1Q?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" target="_blank" class="nav-link" style="background: linear-gradient(135deg, #00C300, #00A000);">
            🍽️ 四維商圈餐車群
          </a>
        </div>
      </div>
    </div>

    <!-- 可愛提醒框 -->
    <div id="cute-alert" class="cute-alert">
      <div class="cute-alert-content">
        <div class="cute-alert-header">
          <div class="cute-alert-icon" id="alert-icon">😊</div>
          <h3 class="cute-alert-title" id="alert-title">溫馨提醒</h3>
        </div>
        <div class="cute-alert-body">
          <div class="cute-alert-message" id="alert-message">請先填寫完整的訂購資訊！</div>
          <div class="cute-alert-details" id="alert-details" style="display: none;">
            <div>📝 請填寫以下資訊：</div>
            <div id="missing-fields"></div>
          </div>
          <button class="cute-alert-button" id="alert-ok-btn">好的，我知道了！</button>
        </div>
      </div>
    </div>

    <!-- 選擇選項的模態框 -->
    <div id="order-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-title" id="modal-title">選擇飲品選項</h3>

        <div class="option-group">
          <label>尺寸價格</label>
          <div class="option-buttons" id="size-options"></div>
        </div>

        <div class="option-group" id="sugar-group">
          <label>甜度</label>
          <div class="option-buttons" id="sugar-options">
            <div class="option-btn selected" data-value="全糖">全糖</div>
            <div class="option-btn" data-value="少糖">少糖</div>
            <div class="option-btn" data-value="半糖">半糖</div>
            <div class="option-btn" data-value="微糖">微糖</div>
            <div class="option-btn" data-value="無糖">無糖</div>
          </div>
        </div>

        <div class="option-group" id="ice-group">
          <label>冰塊</label>
          <div class="option-buttons" id="ice-options">
            <div class="option-btn selected" data-value="正冰">正冰</div>
            <div class="option-btn" data-value="少冰">少冰</div>
            <div class="option-btn" data-value="微冰">微冰</div>
            <div class="option-btn" data-value="去冰">去冰</div>
            <div class="option-btn" data-value="熱飲">熱飲</div>
          </div>
        </div>

        <div class="option-group" id="tea-group" style="display: none;">
          <label>茶品選擇</label>
          <div class="option-buttons" id="tea-options"></div>
        </div>

        <div class="option-group" id="toppings-group" style="display: none;">
          <label>加料選擇</label>
          <div class="option-buttons" id="toppings-options"></div>
        </div>

        <div class="quantity-input">
          <label for="quantity">數量: </label>
          <input type="number" id="quantity" min="1" value="1" pattern="[0-9]*" inputmode="numeric">
        </div>

        <div class="modal-buttons">
          <button class="btn btn-primary" id="add-to-order">加入訂單</button>
          <button class="btn btn-secondary" id="cancel-order">取消</button>
        </div>
      </div>
    </div>

    <!-- 外部JavaScript文件 -->
    <script src="script.js"></script>
  </div>
</body>
</html>
